{"posts":[{"title":"NGINX搭建负载均衡","text":"#user nobody; worker_processes 1; #error_log logs/error.log; #error_log logs/error.log notice; #error_log logs/error.log info; #pid logs/nginx.pid; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; map $http_upgrade $connection_upgrade { default upgrade; '' close; } #log_format main '$remote_addr - $remote_user [$time_local] &quot;$request&quot; ' # '$status $body_bytes_sent &quot;$http_referer&quot; ' # '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;'; #access_log logs/access.log main; #上传文件最大限制 client_max_body_size 500M; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; types_hash_max_size 2048; server_names_hash_max_size 2048; types_hash_bucket_size 1024; #gzip on; upstream websocket { ip_hash; server ip:port; server ip:port; } server { listen 80; server_name www.baidu.com; location / { #此处是nignx负载路径重写，重定向 rewrite ^/$ http://$server_name/DW permanent; add_header X-Content-Type-Options nosniff; proxy_set_header X-scheme $scheme; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header Host $http_host; proxy_set_header X-Nginx-Proxy true; proxy_hide_header X-Powered-By; proxy_hide_header Vary; proxy_pass http://websocket; proxy_http_version 1.1; proxy_set_header Origin ''; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection $connection_upgrade; proxy_connect_timeout 1800; proxy_read_timeout 900; proxy_send_timeout 900; #proxy_set_header Host $host; #proxy_set_header X-Real-IP $remote_addr; #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } } server { listen 80; server_name www.qq.com; location / { #此处是nignx负载路径重写，重定向 rewrite ^/$ http://$server_name/DWeb/dw/index.html permanent; add_header X-Content-Type-Options nosniff; proxy_set_header X-scheme $scheme; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header Host $http_host; proxy_set_header X-Nginx-Proxy true; proxy_hide_header X-Powered-By; proxy_hide_header Vary; proxy_pass http://websocket; proxy_http_version 1.1; proxy_set_header Origin ''; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection $connection_upgrade; proxy_connect_timeout 1800; proxy_read_timeout 900; proxy_send_timeout 900; #proxy_set_header Host $host; #proxy_set_header X-Real-IP $remote_addr; #proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } } } #server { #listen 80; #server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; #location / { # root html; # index index.html index.htm; #} #error_page 404 /404.html; # redirect server error pages to the static page /50x.html # #error_page 500 502 503 504 /50x.html; #location = /50x.html { # root html; #} # proxy the PHP scripts to Apache listening on 127.0.0.1:80 # #location ~ \\.php$ { # proxy_pass http://127.0.0.1; #} # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # #location ~ \\.php$ { # root html; # fastcgi_pass 127.0.0.1:9000; # fastcgi_index index.php; # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name; # include fastcgi_params; #} # deny access to .htaccess files, if Apache's document root # concurs with nginx's one # #location ~ /\\.ht { # deny all; #} #} # another virtual host using mix of IP-, name-, and port-based configuration # #server { # listen 8000; # listen somename:8080; # server_name somename alias another.alias; # location / { # root html; # index index.html index.htm; # } #} # HTTPS server # #server { # listen 443 ssl; # server_name localhost; # ssl_certificate cert.pem; # ssl_certificate_key cert.key; # ssl_session_cache shared:SSL:1m; # ssl_session_timeout 5m; # ssl_ciphers HIGH:!aNULL:!MD5; # ssl_prefer_server_ciphers on; # location / { # root html; # index index.html index.htm; # } #}","link":"/2024/06/05/NGINX%E6%90%AD%E5%BB%BA%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"},{"title":"东方通（TongWeb）定时自动重启任务","text":"#首先执行 crontab -e 进入定时任务内 #然后将下面的任务复制粘贴进去，wq! 保存退出 #重启 crontab 任务即可 #每天早晨 5:00 停机 00 05 * * * cd /opt/TongWeb7.0/bin;./stopserver.sh #每天早晨 5:04 启动 04 05 * * * cd /opt/TongWeb7.0/bin;./startservernohup.sh #每天中午 13:00 停机 00 13 * * * cd /opt/TongWeb7.0/bin;./stopserver.sh #每天中午 13:04 重启 04 13 * * * cd /opt/TongWeb7.0/bin;./startservernohup.sh 太高级了，简直简单的不要不要的！！！！！！！ 又搞定了一个大事儿。","link":"/2024/05/08/%E4%B8%9C%E6%96%B9%E9%80%9A%EF%BC%88TongWeb%EF%BC%89%E5%AE%9A%E6%97%B6%E8%87%AA%E5%8A%A8%E9%87%8D%E5%90%AF%E4%BB%BB%E5%8A%A1/"}],"tags":[{"name":"中间件","slug":"中间件","link":"/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/"}],"categories":[],"pages":[]}